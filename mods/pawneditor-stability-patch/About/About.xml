<?xml version="1.0" encoding="utf-8"?>
<ModMetaData>
  <name>Pawn Editor Stability Patch (Local)</name>
  <author>Segas Wolf</author>
  <packageId>localfix.pawneditor.stability</packageId>
  <supportedVersions>
    <li>1.6</li>
  </supportedVersions>
  <loadAfter>
    <li>isorex.pawneditor</li>
  </loadAfter>
  <description>## Pawn Editor Stability Patch

### Problems Fixed:
- **Failed to initialize tab worker**: NullReferenceException when opening Pawn Editor tabs
- **Duplicate Pawn IDs**: Occasional duplicate pawn IDs when copying/pasting pawns in the editor
- **Texture initialization errors**: Null textures causing UI crashes

### Known Issues (Require Fork to Fix):
- **Age resets to 18**: Changing age in Bio tab doesn't persist correctly. When user sets age, something in the code (likely SetDevStage or related) resets it.
- **Missing body part kills pawn**: When adding "MissingBodyPart" hediff, it marks ALL body parts as missing instead of a specific part, killing the pawn instantly.

### Solution:
- Prefix-based guards that pre-initialize Texture2D fields before they're accessed
- Postfix on LoadItem that detects and fixes duplicate pawn IDs by assigning unique IDs
- Try-catch in Bootstrap to prevent mod load failures

### Load Order:
Place AFTER the Pawn Editor mod (isorex.pawneditor) in your mod list.

### Patches:
- Patch_TabDefInitialize: Guards TabDef.Initialize() for null textures
- Patch_TabWorker_AnimalMech_Initialize: Guards TabWorker_AnimalMech.Initialize() for null textures
- Patch_TabWorker_FactionOverview_GetHeadings: Guards heading initialization
- Patch_SaveLoadUtility_LoadItem: Fixes duplicate pawn IDs after loading

### Future Work (Fork Needed):
- Fix age persistence in BasicInfo.cs - investigate SetDevStage being called after age changes
- Fix MissingBodyPart handling in Hediff/TabWorker_Health - ensure specific body part is selected</description>
</ModMetaData>
